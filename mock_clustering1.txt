import pandas as pd
------------------------------------------------
df=pd.read_csv("Clustering_Mall_Customers.csv")
------------------------------------------------
df
------------------------------------------------
from sklearn.preprocessing import LabelEncoder
label=LabelEncoder()
df[col]=label.fit_transform(df[col])
------------------------------------------------
df.head()
------------------------------------------------
data = df.drop(['CustomerID'], axis=1)
data.head()
------------------------------------------------
X = df[['Annual Income (k$)','Spending Score (1-100)']]
------------------------------------------------
from sklearn.model_selection import train_test_split
X_train, X_test = train_test_split(X, test_size=0.2, random_state=42)
------------------------------------------------
from sklearn.cluster import KMeans, AgglomerativeClustering
kmeans = KMeans(n_clusters=5, random_state=42)
kmeans_labels = kmeans.fit_predict(X)
------------------------------------------------
import matplotlib.pyplot as plt
plt.scatter(X['Annual Income (k$)'], X['Spending Score (1-100)'], c=kmeans_labels)
plt.xlabel("annual INcome")
plt.ylabel("spending")
plt.title("Kmeans")
plt.show()
------------------------------------------------
from sklearn.cluster import AgglomerativeClustering
agg = AgglomerativeClustering(n_clusters=5)
y_agg = agg.fit_predict(X)
------------------------------------------------
plt.scatter(X['Annual Income (k$)'], X['Spending Score (1-100)'], c=y_agg)
plt.xlabel("annual INcome")
plt.ylabel("spending")
plt.title("Agglomerative Clustering")
plt.show()
------------------------------------------------
from sklearn.metrics import silhouette_score
print("Silhouette (KMeans):", silhouette_score(X,kmeans_labels ))
print("Silhouette (Agglomerative):", silhouette_score(X, y_agg))
------------------------------------------------
wcss = []
for i in range(1,11):
km = KMeans(n_clusters=i, random_state=42)
km.fit(X)
wcss.append(km.inertia_)
plt.plot(range(1,11), wcss, marker='o')
plt.xlabel("K")
plt.ylabel("WCSS")
plt.title("Elbow Method")
plt.show()
------------------------------------------------